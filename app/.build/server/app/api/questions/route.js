"use strict";(()=>{var e={};e.id=1330,e.ids=[1330],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},52376:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>y,serverHooks:()=>q,staticGenerationAsyncStorage:()=>g});var o={};r.r(o),r.d(o,{GET:()=>p,POST:()=>d,dynamic:()=>c});var i=r(79182),n=r(72007),s=r(56719),a=r(93442),u=r(53524);let c="force-dynamic",l=new u.PrismaClient;async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("company"),o=t.get("category"),i=t.get("difficulty"),n=t.get("type"),s=t.get("critical"),u=t.get("search"),c={};r&&"all"!==r&&(c.company={slug:r}),o&&"all"!==o&&(c.category={slug:o}),"true"===s&&(c.isCritical=!0);let p={};i&&"all"!==i&&(p.difficulty=i),n&&"all"!==n&&(p.type=n),u&&(p.OR=[{title:{contains:u,mode:"insensitive"}},{content:{contains:u,mode:"insensitive"}}]);let d=await l.companyQuestion.findMany({where:c,orderBy:[{order:"asc"},{createdAt:"desc"}],include:{question:{include:{userNotes:{take:1,orderBy:{updatedAt:"desc"}}}},company:!0,category:!0}}),y=d;Object.keys(p).length>0&&(y=d.filter(e=>{let t=e.question;return!!t&&(!p.difficulty||t.difficulty===p.difficulty)&&(!p.type||t.type===p.type)&&(!p.OR||!!p.OR.some(e=>e.title?.contains?t.title.toLowerCase().includes(e.title.contains.toLowerCase()):!!e.content?.contains&&t.content.toLowerCase().includes(e.content.contains.toLowerCase())))}));let m=y.filter(e=>e.question).map(e=>({...e.question,company:e.company,category:e.category,isCritical:e.isCritical,order:e.order,userNote:e.question.userNotes&&e.question.userNotes.length>0?e.question.userNotes[0]:null}));return a.NextResponse.json(m)}catch(e){return console.error("Error fetching questions:",e),a.NextResponse.json({error:"Failed to fetch questions"},{status:500})}}async function d(e){try{let{title:t,content:r,difficulty:o,type:i,tips:n,followUps:s,isCritical:u,order:c,companyId:p,categoryId:d}=await e.json(),y=await l.question.findUnique({where:{title:t}});y||(y=await l.question.create({data:{title:t,content:r,difficulty:o||"MEDIUM",type:i||"BEHAVIORAL",tips:n||[],followUps:s||[]}}));let m=await l.companyQuestion.create({data:{questionId:y.id,companyId:p,categoryId:d,isCritical:u||!1,order:c||0},include:{question:!0,company:!0,category:!0}}),g={...m.question,company:m.company,category:m.category,isCritical:m.isCritical,order:m.order};return a.NextResponse.json(g,{status:201})}catch(e){return console.error("Error creating question:",e),a.NextResponse.json({error:"Failed to create question"},{status:500})}}let y=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/questions/route",pathname:"/api/questions",filename:"route",bundlePath:"app/api/questions/route"},resolvedPagePath:"/home/ubuntu/em_interview_prep/app/app/api/questions/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:q}=y,f="/api/questions/route";function h(){return(0,s.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[4372,7609],()=>r(52376));module.exports=o})();