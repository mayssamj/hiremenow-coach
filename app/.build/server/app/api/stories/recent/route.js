"use strict";(()=>{var e={};e.id=1122,e.ids=[1122],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8368:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>g,routeModule:()=>c,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{GET:()=>p,dynamic:()=>d});var s=r(79182),n=r(72007),o=r(56719),i=r(93442),u=r(53524);let d="force-dynamic",l=new u.PrismaClient;async function p(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("limit")||"10"),a=[];try{let e=await l.storyQuestion.findMany({orderBy:{lastUsed:"desc"},take:2*r,include:{story:{include:{tags:{include:{tag:!0}}}}}}),t=new Set;for(let s of e)!t.has(s.story.id)&&a.length<r&&(t.add(s.story.id),a.push({...s.story,tags:s.story.tags.map(e=>e.tag),lastUsed:s.lastUsed,usageCount:s.usageCount}));if(a.length<r){let e=(await l.story.findMany({where:{id:{notIn:Array.from(t)}},orderBy:{updatedAt:"desc"},take:r-a.length,include:{tags:{include:{tag:!0}}}})).map(e=>({...e,tags:e.tags.map(e=>e.tag),lastUsed:null,usageCount:0}));a.push(...e)}}catch(e){console.log("Falling back to regular stories:",e),a=(await l.story.findMany({orderBy:{updatedAt:"desc"},take:r,include:{tags:{include:{tag:!0}}}})).map(e=>({...e,tags:e.tags.map(e=>e.tag),lastUsed:null,usageCount:0}))}return i.NextResponse.json(a)}catch(e){return console.error("Error fetching recent stories:",e),i.NextResponse.json({error:"Failed to fetch recent stories"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/stories/recent/route",pathname:"/api/stories/recent",filename:"route",bundlePath:"app/api/stories/recent/route"},resolvedPagePath:"/home/ubuntu/em_interview_prep/app/app/api/stories/recent/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:y}=c,h="/api/stories/recent/route";function f(){return(0,o.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[4372,7609],()=>r(8368));module.exports=a})();