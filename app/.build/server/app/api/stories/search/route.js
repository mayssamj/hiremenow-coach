"use strict";(()=>{var e={};e.id=8138,e.ids=[8138],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},30119:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var i={};s.r(i),s.d(i,{GET:()=>d,dynamic:()=>c});var n=s(79182),r=s(72007),a=s(56719),o=s(93442),u=s(53524);let c="force-dynamic",p=new u.PrismaClient;async function d(e){try{let{searchParams:t}=new URL(e.url),s=t.get("q")||"",i=t.get("tags")?.split(",").filter(Boolean)||[],n="true"===t.get("recent"),r=parseInt(t.get("limit")||"20"),a={};s&&(a.OR=[{title:{contains:s,mode:"insensitive"}},{content:{contains:s,mode:"insensitive"}},{situation:{contains:s,mode:"insensitive"}},{task:{contains:s,mode:"insensitive"}},{action:{contains:s,mode:"insensitive"}},{result:{contains:s,mode:"insensitive"}}]),i.length>0&&(a.tags={some:{tag:{name:{in:i}}}});let u={updatedAt:"desc"};n&&(u={updatedAt:"desc"});let c=(await p.story.findMany({where:a,orderBy:u,take:r,include:{tags:{include:{tag:!0}},questions:{take:3,include:{question:{select:{id:!0,title:!0}}}}}})).map(e=>({...e,tags:e.tags.map(e=>e.tag),recentQuestions:e.questions.map(e=>e.question)}));return o.NextResponse.json(c)}catch(e){return console.error("Error searching stories:",e),o.NextResponse.json({error:"Failed to search stories"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/stories/search/route",pathname:"/api/stories/search",filename:"route",bundlePath:"app/api/stories/search/route"},resolvedPagePath:"/home/ubuntu/em_interview_prep/app/app/api/stories/search/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:h}=l,v="/api/stories/search/route";function x(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),i=t.X(0,[4372,7609],()=>s(30119));module.exports=i})();